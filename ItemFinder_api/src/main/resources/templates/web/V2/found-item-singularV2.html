<!DOCTYPE html>
<html lang="en" data-bs-theme="light">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Dashboard - ItemFinder</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i&display=swap">
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/fonts/fontawesome-all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
    <style>
        #map {
            align-self: center;
            width: 700px; /* Make it the same width as the card */
            height: 500px; /* Adjust the height to make it smaller */
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body id="page-top">
<div id="wrapper">

    <!-- Sidebar -->
    <nav class="navbar align-items-start sidebar sidebar-dark accordion bg-gradient-primary p-0 navbar-dark">
        <div class="container-fluid d-flex flex-column p-0"><a class="navbar-brand d-flex justify-content-center align-items-center sidebar-brand m-0" href="#">
            <div class="sidebar-brand-icon rotate-n-15"><i class="fas fa-laugh-wink"></i></div>
            <div class="sidebar-brand-text mx-3"><span>ItemFinder</span></div>
        </a>
            <hr class="sidebar-divider my-0">
            <ul class="navbar-nav text-light" id="accordionSidebar">
                <li class="nav-item"><a class="nav-link active" href="/test-site3"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a></li>
                <li class="nav-item"><a class="nav-link" href="/found-itemsV2"><i class="fas fa-user"></i><span>Found Items</span></a></li>
                <li class="nav-item"><a class="nav-link" href="/lost-itemsV2"><i class="fas fa-table"></i><span>Lost Items</span></a></li>
                <li class="nav-item"><a class="nav-link" href="/add-lostV2"><i class="far fa-user-circle"></i><span>Lost it</span></a></li>
                <li class="nav-item"><a class="nav-link" href="/add-foundV2"><i class="fas fa-user-circle"></i><span>Found it</span></a></li>
                <li class="nav-item"><a class="nav-link" href="/loginV2"><i class="fas fa-key"></i><span>Sign in</span></a></li>
                <li class="nav-item"><a class="nav-link" href="/registerV2"><i class="fas fa-key"></i><span>Sign up</span></a></li>
            </ul>
            <div class="text-center d-none d-md-inline"><button class="btn rounded-circle border-0" id="sidebarToggle" type="button"></button></div>
        </div>
    </nav>
    <!-- Your Sidebar code remains the same -->

    <!-- Content Wrapper -->
    <div class="d-flex flex-column" id="content-wrapper">
        <div id="content">
            <!-- Top Bar -->
            <!-- Your Top Bar code remains the same -->
            <nav class="navbar navbar-expand bg-white shadow mb-4 topbar">
                <div class="container-fluid"><button class="btn btn-link d-md-none rounded-circle me-3" id="sidebarToggleTop" type="button"><i class="fas fa-bars"></i></button>
                    <form class="d-none d-sm-inline-block me-auto ms-md-3 my-2 my-md-0 mw-100 navbar-search" action="/search-lost-items" method="GET">
                        <div class="input-group">
                            <input class="bg-light form-control border-0 small" type="text" name="name" placeholder="Search for items...">
                            <button class="btn btn-primary py-0" type="submit"><i class="fas fa-search"></i></button>
                        </div>
                    </form>
                    <div class="nav-item dropdown no-arrow">
                        <a class="dropdown-toggle nav-link" aria-expanded="false" data-bs-toggle="dropdown" href="#">
                            <span class="d-none d-lg-inline me-2 text-gray-600 small" th:text="${#authentication.name}"></span>
                            <img class="border rounded-circle img-profile" src="img/avatars/avatar1.jpeg">
                        </a>
                        <div class="dropdown-menu shadow dropdown-menu-end animated--grow-in">
                            <a class="dropdown-item" href="#">
                                <i class="fas fa-user fa-sm fa-fw me-2 text-gray-400"></i>
                                &nbsp;Profile</a>
                            <a class="dropdown-item" href="#">
                                <i class="fas fa-cogs fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Settings</a>
                            <a class="dropdown-item" href="#">
                                <i class="fas fa-list fa-sm fa-fw me-2 text-gray-400">
                                </i>&nbsp;Activity log</a>
                            <div class="dropdown-divider"></div><a class="dropdown-item" href="/logout" methods="post"><i class="fas fa-sign-out-alt fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Logout</a>

                        </div>
                    </div>
                </div>
            </nav>

            <main class="container my-5">
                <div class="row">
                    <div class="col-md-8 offset-md-2">
                        <!-- Item Details -->
                        <div class="card shadow">
                            <div class="card-body">
                                <div class="text-center">
                                    <img th:src="${item.ImageUrlOrDummy}" th:alt="${'Image of ' + item.ItemName}" class="img-fluid rounded mb-3" style="max-width: 100%; height: auto;">
                                    <h2 class="card-title" th:text="${item.ItemName}">Item Name</h2>
                                    <p class="card-text" th:text="${item.ItemDescriptionOrEmpty}">Short description of the item.</p>
                                    <p class="card-text" th:text="${item.CreatorId}">Creator ID</p>
                                    <p class="card-text">
                                        <strong>Creator:</strong>
                                        <span th:text="${creatorName}">Creator Name</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Map Section -->
                <div class="container py-4">
                    <h1 class="text-center mb-4" th:if="${item.Latitude != null && item.Longitude != null}">Map</h1>
                    <div th:if="${item.Latitude == null || item.Longitude == null}" class="text-center">
                        <p>No coordinates provided.</p>
                    </div>
                    <div class="d-flex justify-content-center align-items-center">
                    <div   id="map" th:if="${item.Latitude != null && item.Longitude != null}"
                         th:data-lat="${item.Latitude}"
                         th:data-lng="${item.Longitude}"
                         class="rounded shadow">
                    </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Retrieve coordinates from data attributes
        const latitude = parseFloat(document.getElementById('map').getAttribute('data-lat'));
        const longitude = parseFloat(document.getElementById('map').getAttribute('data-lng'));

        // Check if the coordinates are valid numbers
        if (!isNaN(latitude) && !isNaN(longitude)) {
            // Initialize the map at the item's coordinates
            const map = L.map('map').setView([latitude, longitude], 15);

            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '&copy; OpenStreetMap contributors'
            }).addTo(map);

            // Add a marker at the item's location
            L.marker([latitude, longitude]).addTo(map)
                //.bindPopup('Item Location')
               // .openPopup();
        } else {
            console.error('Invalid coordinates: ', latitude, longitude);
        }
    });
</script>

<footer class="bg-white sticky-footer">
    <div class="container my-auto">
        <div class="text-center my-auto copyright"><span>Copyright Â© ItemFinder 2024</span></div>
    </div>
</footer>
</body>

</html>
